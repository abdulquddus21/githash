"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/upload";
exports.ids = ["pages/api/upload"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "form-data":
/*!****************************!*\
  !*** external "form-data" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("form-data");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupload.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupload.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\upload.js */ \"(api)/./pages/api/upload.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/upload\",\n        pathname: \"/api/upload\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVwbG9hZCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDdXBsb2FkLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ29EO0FBQ3BEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJpdmF0ZS8/YjNmNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXHVwbG9hZC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3VwbG9hZFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3VwbG9hZFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupload.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/upload.js":
/*!*****************************!*\
  !*** ./pages/api/upload.js ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! os */ \"os\");\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(os__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var form_data__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! form-data */ \"form-data\");\n/* harmony import */ var form_data__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(form_data__WEBPACK_IMPORTED_MODULE_9__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_1__, axios__WEBPACK_IMPORTED_MODULE_8__]);\n([formidable__WEBPACK_IMPORTED_MODULE_1__, axios__WEBPACK_IMPORTED_MODULE_8__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n\n\n\n\nconst execAsync = (0,util__WEBPACK_IMPORTED_MODULE_7__.promisify)(child_process__WEBPACK_IMPORTED_MODULE_6__.exec);\n// Supabase sozlamalari\nconst SUPABASE_URL = \"https://xzbwfoacsnrmgjmildcr.supabase.co\";\nconst SUPABASE_ANON_KEY = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh6Yndmb2Fjc25ybWdqbWlsZGNyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxOTkxNzUsImV4cCI6MjA3Mzc3NTE3NX0.c10rEbuzQIkVvuJEecEltokgaj6AqjyP5IoFVffjizc\";\n// Catbox.moe sozlamalari - fayl ichida saqlangan\nconst CATBOX_USER_HASH = \"f5b7fa9dcde44f181587045cf\";\nconst CATBOX_API_URL = \"https://catbox.moe/user/api.php\";\n// Video formatlarini aniqlash\nconst VIDEO_FORMATS = [\n    \"video/mp4\",\n    \"video/avi\",\n    \"video/mov\",\n    \"video/wmv\",\n    \"video/flv\",\n    \"video/webm\",\n    \"video/mkv\",\n    \"video/3gp\",\n    \"video/m4v\",\n    \"video/quicktime\"\n];\n// Video kompressiya sozlamalari\nconst VIDEO_COMPRESSION_SETTINGS = {\n    resolution: \"720x480\",\n    videoBitrate: \"800k\",\n    audioBitrate: \"128k\",\n    fps: 30,\n    codec: \"libx264\",\n    audioCodec: \"aac\",\n    preset: \"fast\",\n    crf: 28\n};\n// FFmpeg mavjudligini tekshirish\nasync function checkFFmpegAvailability() {\n    try {\n        const { stdout } = await execAsync(\"ffmpeg -version\");\n        if (stdout.includes(\"ffmpeg version\")) {\n            console.log(\"✅ FFmpeg mavjud\");\n            return true;\n        }\n    } catch (error) {\n        console.log(\"❌ FFmpeg topilmadi, video kompressiya o'chiriladi\");\n        return false;\n    }\n    return false;\n}\n// Video faylni siqish\nasync function compressVideo(inputPath, outputPath, mimeType) {\n    try {\n        console.log(\"\\uD83C\\uDFAC Video kompressiya boshlanmoqda...\");\n        console.log(\"\\uD83D\\uDCE5 Input:\", inputPath);\n        console.log(\"\\uD83D\\uDCE4 Output:\", outputPath);\n        const ffmpegCommand = [\n            \"ffmpeg\",\n            \"-i\",\n            `\"${inputPath}\"`,\n            \"-c:v\",\n            VIDEO_COMPRESSION_SETTINGS.codec,\n            \"-c:a\",\n            VIDEO_COMPRESSION_SETTINGS.audioCodec,\n            \"-b:v\",\n            VIDEO_COMPRESSION_SETTINGS.videoBitrate,\n            \"-b:a\",\n            VIDEO_COMPRESSION_SETTINGS.audioBitrate,\n            \"-r\",\n            VIDEO_COMPRESSION_SETTINGS.fps,\n            \"-crf\",\n            VIDEO_COMPRESSION_SETTINGS.crf,\n            \"-preset\",\n            VIDEO_COMPRESSION_SETTINGS.preset,\n            \"-vf\",\n            `scale=${VIDEO_COMPRESSION_SETTINGS.resolution}:force_original_aspect_ratio=decrease,pad=${VIDEO_COMPRESSION_SETTINGS.resolution}:(ow-iw)/2:(oh-ih)/2`,\n            \"-movflags\",\n            \"+faststart\",\n            \"-y\",\n            `\"${outputPath}\"`\n        ].join(\" \");\n        const startTime = Date.now();\n        const { stdout, stderr } = await execAsync(ffmpegCommand, {\n            timeout: 300000,\n            maxBuffer: 1024 * 1024 * 10\n        });\n        const endTime = Date.now();\n        const duration = ((endTime - startTime) / 1000).toFixed(2);\n        if ((0,fs__WEBPACK_IMPORTED_MODULE_3__.existsSync)(outputPath)) {\n            const originalStats = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().stat(inputPath);\n            const compressedStats = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().stat(outputPath);\n            const originalSize = originalStats.size;\n            const compressedSize = compressedStats.size;\n            const compressionRatio = ((originalSize - compressedSize) / originalSize * 100).toFixed(2);\n            console.log(\"✅ Video kompressiya tugadi\");\n            console.log(`📊 Asl hajm: ${(originalSize / 1024 / 1024).toFixed(2)}MB`);\n            console.log(`📊 Yangi hajm: ${(compressedSize / 1024 / 1024).toFixed(2)}MB`);\n            console.log(`📊 Tejash: ${compressionRatio}%`);\n            console.log(`⏱️ Vaqt: ${duration}s`);\n            return {\n                success: true,\n                originalSize,\n                compressedSize,\n                compressionRatio: parseFloat(compressionRatio),\n                duration: parseFloat(duration)\n            };\n        } else {\n            throw new Error(\"Kompressiya natijasida fayl yaratilmadi\");\n        }\n    } catch (error) {\n        console.error(\"❌ Video kompressiya xatosi:\", error.message);\n        if (error.message.includes(\"timeout\") || error.message.includes(\"ffmpeg\")) {\n            console.log(\"⚠️ Kompressiya muvaffaqiyatsiz, asl fayl ishlatiladi\");\n            return {\n                success: false,\n                error: error.message,\n                useOriginal: true\n            };\n        }\n        throw error;\n    }\n}\n// Video fayl ekanligini aniqlash\nfunction isVideoFile(mimeType, filename) {\n    if (mimeType && VIDEO_FORMATS.includes(mimeType.toLowerCase())) {\n        return true;\n    }\n    const videoExtensions = [\n        \".mp4\",\n        \".avi\",\n        \".mov\",\n        \".wmv\",\n        \".flv\",\n        \".webm\",\n        \".mkv\",\n        \".3gp\",\n        \".m4v\"\n    ];\n    const extension = path__WEBPACK_IMPORTED_MODULE_4___default().extname(filename).toLowerCase();\n    return videoExtensions.includes(extension);\n}\n// Fayl nomini tozalash\nfunction sanitizeFilename(filename) {\n    return filename.replace(/[^a-zA-Z0-9\\-_\\.]/g, \"_\").replace(/_{2,}/g, \"_\").toLowerCase();\n}\n// Faylni Catbox.moe ga yuklash\nasync function uploadFileToCatbox(filePath, fileName, mimeType) {\n    try {\n        if (!(0,fs__WEBPACK_IMPORTED_MODULE_3__.existsSync)(filePath)) {\n            throw new Error(`Fayl topilmadi: ${filePath}`);\n        }\n        console.log(\"\\uD83D\\uDCE4 Uploading to Catbox:\", fileName);\n        const fileBuffer = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().readFile(filePath);\n        const fileSizeMB = (fileBuffer.length / 1024 / 1024).toFixed(2);\n        console.log(\"\\uD83D\\uDCC1 File size:\", fileSizeMB, \"MB\");\n        // Katta fayllar uchun warning (Catbox max 200MB, ammo user 1GB so'ragan, lekin cheklash kodda qo'yiladi)\n        if (fileBuffer.length > 200 * 1024 * 1024) {\n            throw new Error(\"Fayl hajmi Catbox.moe uchun juda katta (max 200MB)\");\n        }\n        const form = new (form_data__WEBPACK_IMPORTED_MODULE_9___default())();\n        form.append(\"reqtype\", \"fileupload\");\n        form.append(\"userhash\", CATBOX_USER_HASH);\n        form.append(\"fileToUpload\", fileBuffer, {\n            filename: fileName,\n            contentType: mimeType || \"application/octet-stream\"\n        });\n        console.log(\"\\uD83D\\uDD17 Uploading to Catbox API...\");\n        const uploadStartTime = Date.now();\n        const response = await axios__WEBPACK_IMPORTED_MODULE_8__[\"default\"].post(CATBOX_API_URL, form, {\n            headers: {\n                ...form.getHeaders()\n            },\n            timeout: 300000 // 5 minut\n        });\n        const uploadDuration = ((Date.now() - uploadStartTime) / 1000).toFixed(2);\n        if (response.status !== 200 || !response.data.startsWith(\"https://\")) {\n            throw new Error(`Upload muvaffaqiyatsiz: ${response.data}`);\n        }\n        const publicUrl = response.data.trim();\n        console.log(\"✅ Upload successful:\", publicUrl);\n        console.log(\"⏱️ Upload time:\", uploadDuration, \"seconds\");\n        console.log(\"\\uD83D\\uDCCA Upload speed:\", (fileBuffer.length / 1024 / 1024 / uploadDuration).toFixed(2), \"MB/s\");\n        return {\n            fileName: fileName,\n            publicUrl: publicUrl\n        };\n    } catch (error) {\n        console.error(\"❌ Upload error:\", error.message);\n        if (error.response) {\n            console.error(\"Upload response status:\", error.response.status);\n            console.error(\"Upload response data:\", error.response.data);\n        }\n        throw new Error(`Upload xatosi: ${error.message}`);\n    }\n}\n// Vaqtinchalik faylni o'chirish\nasync function cleanupTempFile(filePath) {\n    try {\n        if ((0,fs__WEBPACK_IMPORTED_MODULE_3__.existsSync)(filePath)) {\n            await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().unlink(filePath);\n            console.log(\"\\uD83D\\uDDD1️ Temp file deleted:\", filePath);\n        }\n    } catch (error) {\n        console.warn(\"⚠️ Temp file deletion warning:\", error.message);\n    }\n}\nconst config = {\n    api: {\n        bodyParser: false,\n        responseLimit: false\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Faqat POST so'rovlari qabul qilinadi\",\n            method: req.method\n        });\n    }\n    console.log(\"\\uD83D\\uDE80 Starting upload process...\");\n    console.log(\"\\uD83C\\uDF10 Request headers:\", {\n        \"content-type\": req.headers[\"content-type\"],\n        \"content-length\": req.headers[\"content-length\"],\n        \"user-agent\": req.headers[\"user-agent\"]\n    });\n    // FFmpeg mavjudligini tekshirish\n    const isFFmpegAvailable = await checkFFmpegAvailability();\n    try {\n        // Vaqtinchalik papka sozlash\n        let tempDir;\n        try {\n            tempDir = os__WEBPACK_IMPORTED_MODULE_5___default().tmpdir();\n            console.log(\"\\uD83D\\uDCC1 Using temp directory:\", tempDir);\n            if (!(0,fs__WEBPACK_IMPORTED_MODULE_3__.existsSync)(tempDir)) {\n                await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().mkdir(tempDir, {\n                    recursive: true\n                });\n                console.log(\"\\uD83D\\uDCC1 Created temp directory:\", tempDir);\n            }\n        } catch (tempError) {\n            console.error(\"❌ Temp directory error:\", tempError.message);\n            tempDir = path__WEBPACK_IMPORTED_MODULE_4___default().join(process.cwd(), \"temp\");\n            if (!(0,fs__WEBPACK_IMPORTED_MODULE_3__.existsSync)(tempDir)) {\n                await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().mkdir(tempDir, {\n                    recursive: true\n                });\n                console.log(\"\\uD83D\\uDCC1 Created fallback temp directory:\", tempDir);\n            }\n        }\n        // Formidable sozlamalari - max 1GB per file\n        const form = (0,formidable__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            multiples: true,\n            uploadDir: tempDir,\n            keepExtensions: true,\n            allowEmptyFiles: false,\n            minFileSize: 1,\n            maxFileSize: 1024 * 1024 * 1024,\n            maxFiles: Infinity,\n            maxTotalFileSize: Infinity,\n            maxFieldsSize: Infinity,\n            createDirsFromUploads: true\n        });\n        console.log(\"\\uD83D\\uDCCB Parsing form data...\");\n        const { fields, files } = await new Promise((resolve, reject)=>{\n            form.parse(req, (err, fields, files)=>{\n                if (err) {\n                    console.error(\"❌ Form parsing error:\", err.message);\n                    reject(new Error(`Form parsing xatosi: ${err.message}`));\n                } else {\n                    console.log(\"✅ Form parsed successfully\");\n                    resolve({\n                        fields,\n                        files\n                    });\n                }\n            });\n        });\n        console.log(\"\\uD83D\\uDCC1 Files received:\", Object.keys(files));\n        console.log(\"\\uD83D\\uDCDD Fields received:\", Object.keys(fields));\n        if (!files.file) {\n            return res.status(400).json({\n                error: \"Hech qanday fayl yuklanmadi\",\n                received: Object.keys(files)\n            });\n        }\n        const uploadedFiles = Array.isArray(files.file) ? files.file : [\n            files.file\n        ];\n        const totalSize = uploadedFiles.reduce((sum, file)=>sum + (file.size || 0), 0);\n        const type = Array.isArray(fields.type) ? fields.type[0] : fields.type || \"post\";\n        const username = Array.isArray(fields.username) ? fields.username[0] : fields.username;\n        const postIndex = Array.isArray(fields.postIndex) ? fields.postIndex[0] : fields.postIndex;\n        if (!username) {\n            return res.status(400).json({\n                error: \"Username majburiy\",\n                fields: Object.keys(fields)\n            });\n        }\n        console.log(`📊 Upload session: type=${type}, username=${username}, files=${uploadedFiles.length}`);\n        console.log(`📊 Total size: ${(totalSize / 1024 / 1024).toFixed(2)} MB`);\n        console.log(`🎬 Video compression: ${isFFmpegAvailable ? \"ENABLED\" : \"DISABLED\"}`);\n        const results = [];\n        const errors = [];\n        // Har bir faylni yuklash\n        for(let i = 0; i < uploadedFiles.length; i++){\n            const file = uploadedFiles[i];\n            let tempFilePath = null;\n            let compressedFilePath = null;\n            try {\n                const originalName = file.originalFilename || `file_${i + 1}`;\n                const mimeType = file.mimetype || \"application/octet-stream\";\n                const fileSize = file.size || 0;\n                tempFilePath = file.filepath;\n                console.log(`📤 Processing ${i + 1}/${uploadedFiles.length}: ${originalName}`);\n                console.log(`📊 Size: ${(fileSize / 1024 / 1024).toFixed(2)}MB, Type: ${mimeType}`);\n                if (fileSize === 0) {\n                    throw new Error(\"Bo'sh fayl\");\n                }\n                if (!(0,fs__WEBPACK_IMPORTED_MODULE_3__.existsSync)(tempFilePath)) {\n                    console.log(\"⏳ File not found, waiting 1 second...\");\n                    await new Promise((resolve)=>setTimeout(resolve, 1000));\n                    if (!(0,fs__WEBPACK_IMPORTED_MODULE_3__.existsSync)(tempFilePath)) {\n                        throw new Error(`Vaqtinchalik fayl topilmadi: ${tempFilePath}`);\n                    }\n                }\n                const fileStats = await fs_promises__WEBPACK_IMPORTED_MODULE_2___default().stat(tempFilePath);\n                const actualFileSize = fileStats.size;\n                console.log(`📊 File stats: reported=${fileSize}, actual=${actualFileSize}`);\n                if (actualFileSize === 0) {\n                    throw new Error(\"Bo'sh fayl\");\n                }\n                // Video kompressiya\n                let finalFilePath = tempFilePath;\n                let finalFileSize = actualFileSize;\n                let compressionInfo = null;\n                if (isFFmpegAvailable && isVideoFile(mimeType, originalName)) {\n                    console.log(\"\\uD83C\\uDFAC Video fayl aniqlandi, kompressiya boshlanmoqda...\");\n                    const compressedName = `compressed_${Date.now()}_${path__WEBPACK_IMPORTED_MODULE_4___default().basename(tempFilePath, path__WEBPACK_IMPORTED_MODULE_4___default().extname(tempFilePath))}.mp4`;\n                    compressedFilePath = path__WEBPACK_IMPORTED_MODULE_4___default().join(tempDir, compressedName);\n                    try {\n                        compressionInfo = await compressVideo(tempFilePath, compressedFilePath, mimeType);\n                        if (compressionInfo.success) {\n                            finalFilePath = compressedFilePath;\n                            finalFileSize = compressionInfo.compressedSize;\n                            console.log(`✅ Video kompressiya muvaffaqiyatli: ${compressionInfo.compressionRatio}% tejash`);\n                        } else if (compressionInfo.useOriginal) {\n                            console.log(\"⚠️ Kompressiya ishlamadi, asl fayl ishlatiladi\");\n                        }\n                    } catch (compressionError) {\n                        console.error(\"❌ Video kompressiya xatosi:\", compressionError.message);\n                        console.log(\"⚠️ Asl fayl ishlatiladi\");\n                    }\n                }\n                // Fayl nomini yaratish\n                const safeOriginalName = sanitizeFilename(originalName);\n                const fileExtension = compressionInfo?.success ? \".mp4\" : path__WEBPACK_IMPORTED_MODULE_4___default().extname(safeOriginalName) || \"\";\n                const timestamp = Date.now();\n                const randomId = Math.random().toString(36).substring(2, 8);\n                let fileName;\n                if (type === \"profile\") {\n                    fileName = `profiles/${username}_${timestamp}_${randomId}${fileExtension}`;\n                } else {\n                    const postSuffix = postIndex ? `_post${postIndex}` : \"\";\n                    const fileSuffix = uploadedFiles.length > 1 ? `_${i + 1}` : \"\";\n                    fileName = `posts/${username}${postSuffix}${fileSuffix}_${timestamp}_${randomId}${fileExtension}`;\n                }\n                console.log(`🎯 Destination: ${fileName}`);\n                // Faylni yuklash\n                const uploadResult = await uploadFileToCatbox(finalFilePath, fileName, compressionInfo?.success ? \"video/mp4\" : mimeType);\n                // Umumiy URL\n                const publicUrl = uploadResult.publicUrl;\n                results.push({\n                    success: true,\n                    url: publicUrl,\n                    filename: uploadResult.fileName,\n                    originalName: originalName,\n                    fileSize: finalFileSize,\n                    originalFileSize: actualFileSize,\n                    mimeType: compressionInfo?.success ? \"video/mp4\" : mimeType,\n                    type: type,\n                    fileIndex: i + 1,\n                    totalFiles: uploadedFiles.length,\n                    compressed: compressionInfo?.success || false,\n                    compressionRatio: compressionInfo?.compressionRatio || null,\n                    compressionDuration: compressionInfo?.duration || null\n                });\n                console.log(`✅ Success ${i + 1}/${uploadedFiles.length}: ${originalName}`);\n            } catch (fileError) {\n                console.error(`❌ File error ${i + 1}/${uploadedFiles.length}:`, fileError.message);\n                errors.push({\n                    filename: file.originalFilename || `file_${i + 1}`,\n                    error: fileError.message,\n                    fileIndex: i + 1\n                });\n            } finally{\n                // Vaqtinchalik fayllarni o'chirish\n                if (tempFilePath) {\n                    await cleanupTempFile(tempFilePath);\n                }\n                if (compressedFilePath && compressedFilePath !== tempFilePath) {\n                    await cleanupTempFile(compressedFilePath);\n                }\n            }\n        }\n        // Natija\n        const response = {\n            success: errors.length === 0,\n            uploaded: results,\n            errors: errors,\n            summary: {\n                totalFiles: uploadedFiles.length,\n                successful: results.length,\n                failed: errors.length,\n                totalSize: totalSize < 1024 * 1024 ? `${(totalSize / 1024).toFixed(2)}KB` : `${(totalSize / 1024 / 1024).toFixed(2)}MB`,\n                videosCompressed: results.filter((r)=>r.compressed).length,\n                ffmpegAvailable: isFFmpegAvailable\n            }\n        };\n        console.log(\"\\uD83C\\uDF89 Upload complete:\", response.summary);\n        const statusCode = errors.length === 0 ? 200 : results.length > 0 ? 207 : 400;\n        return res.status(statusCode).json(response);\n    } catch (error) {\n        console.error(\"❌ Global error:\", error.message);\n        console.error(\"Stack:\", error.stack);\n        return res.status(500).json({\n            error: \"Server xatoligi\",\n            details: error.message,\n            timestamp: new Date().toISOString(),\n            env_check: {\n                hasUserHash: !!CATBOX_USER_HASH,\n                nodeEnv: \"development\"\n            }\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU0sQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRVQsVUFBVSxFQUFFckcsTUFBTTtnQkFDMUQrRyxpQkFBaUJwRjtZQUNuQjtRQUNGO1FBRUF2RSxRQUFRQyxHQUFHLENBQUMsaUNBQXVCZ0QsU0FBU29HLE9BQU87UUFFbkQsTUFBTU8sYUFBYTdDLE9BQU9uRSxNQUFNLEtBQUssSUFBSSxNQUFPa0UsUUFBUWxFLE1BQU0sR0FBRyxJQUFJLE1BQU07UUFDM0UsT0FBT3dCLElBQUlkLE1BQU0sQ0FBQ3NHLFlBQVl0RixJQUFJLENBQUNyQjtJQUVyQyxFQUFFLE9BQU8vQyxPQUFPO1FBQ2RGLFFBQVFFLEtBQUssQ0FBQyxtQkFBbUJBLE1BQU0wQixPQUFPO1FBQzlDNUIsUUFBUUUsS0FBSyxDQUFDLFVBQVVBLE1BQU0ySixLQUFLO1FBRW5DLE9BQU96RixJQUFJZCxNQUFNLENBQUMsS0FBS2dCLElBQUksQ0FBQztZQUMxQnBFLE9BQU87WUFDUDRKLFNBQVM1SixNQUFNMEIsT0FBTztZQUN0QnVHLFdBQVcsSUFBSXpILE9BQU9xSixXQUFXO1lBQ2pDQyxXQUFXO2dCQUNUQyxhQUFhLENBQUMsQ0FBQ2hMO2dCQUNmaUwsU0FqZVI7WUFrZU07UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcml2YXRlLy4vcGFnZXMvYXBpL3VwbG9hZC5qcz81NTcyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XHJcbmltcG9ydCBmb3JtaWRhYmxlIGZyb20gJ2Zvcm1pZGFibGUnO1xyXG5pbXBvcnQgZnMgZnJvbSAnZnMvcHJvbWlzZXMnO1xyXG5pbXBvcnQgeyBleGlzdHNTeW5jIH0gZnJvbSAnZnMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0IG9zIGZyb20gJ29zJztcclxuaW1wb3J0IHsgZXhlYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xyXG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJztcclxuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcclxuaW1wb3J0IEZvcm1EYXRhIGZyb20gJ2Zvcm0tZGF0YSc7XHJcblxyXG5jb25zdCBleGVjQXN5bmMgPSBwcm9taXNpZnkoZXhlYyk7XHJcblxyXG4vLyBTdXBhYmFzZSBzb3psYW1hbGFyaVxyXG5jb25zdCBTVVBBQkFTRV9VUkwgPSAnaHR0cHM6Ly94emJ3Zm9hY3Nucm1nam1pbGRjci5zdXBhYmFzZS5jbyc7XHJcbmNvbnN0IFNVUEFCQVNFX0FOT05fS0VZID0gJ2V5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUpwYzNNaU9pSnpkWEJoWW1GelpTSXNJbkpsWmlJNkluaDZZbmRtYjJGamMyNXliV2RxYldsc1pHTnlJaXdpY205c1pTSTZJbUZ1YjI0aUxDSnBZWFFpT2pFM05UZ3hPVGt4TnpVc0ltVjRjQ0k2TWpBM016YzNOVEUzTlgwLmMxMHJFYnV6UUlrVnZ1SkVlY0VsdG9rZ2FqNkFxanlQNUlvRlZmZmppemMnO1xyXG5cclxuLy8gQ2F0Ym94Lm1vZSBzb3psYW1hbGFyaSAtIGZheWwgaWNoaWRhIHNhcWxhbmdhblxyXG5jb25zdCBDQVRCT1hfVVNFUl9IQVNIID0gJ2Y1YjdmYTlkY2RlNDRmMTgxNTg3MDQ1Y2YnO1xyXG5jb25zdCBDQVRCT1hfQVBJX1VSTCA9ICdodHRwczovL2NhdGJveC5tb2UvdXNlci9hcGkucGhwJztcclxuXHJcbi8vIFZpZGVvIGZvcm1hdGxhcmluaSBhbmlxbGFzaFxyXG5jb25zdCBWSURFT19GT1JNQVRTID0gW1xyXG4gICd2aWRlby9tcDQnLCAndmlkZW8vYXZpJywgJ3ZpZGVvL21vdicsICd2aWRlby93bXYnLCAndmlkZW8vZmx2JywgXHJcbiAgJ3ZpZGVvL3dlYm0nLCAndmlkZW8vbWt2JywgJ3ZpZGVvLzNncCcsICd2aWRlby9tNHYnLCAndmlkZW8vcXVpY2t0aW1lJ1xyXG5dO1xyXG5cclxuLy8gVmlkZW8ga29tcHJlc3NpeWEgc296bGFtYWxhcmlcclxuY29uc3QgVklERU9fQ09NUFJFU1NJT05fU0VUVElOR1MgPSB7XHJcbiAgcmVzb2x1dGlvbjogJzcyMHg0ODAnLFxyXG4gIHZpZGVvQml0cmF0ZTogJzgwMGsnLFxyXG4gIGF1ZGlvQml0cmF0ZTogJzEyOGsnLFxyXG4gIGZwczogMzAsXHJcbiAgY29kZWM6ICdsaWJ4MjY0JyxcclxuICBhdWRpb0NvZGVjOiAnYWFjJyxcclxuICBwcmVzZXQ6ICdmYXN0JyxcclxuICBjcmY6IDI4XHJcbn07XHJcblxyXG4vLyBGRm1wZWcgbWF2anVkbGlnaW5pIHRla3NoaXJpc2hcclxuYXN5bmMgZnVuY3Rpb24gY2hlY2tGRm1wZWdBdmFpbGFiaWxpdHkoKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgc3Rkb3V0IH0gPSBhd2FpdCBleGVjQXN5bmMoJ2ZmbXBlZyAtdmVyc2lvbicpO1xyXG4gICAgaWYgKHN0ZG91dC5pbmNsdWRlcygnZmZtcGVnIHZlcnNpb24nKSkge1xyXG4gICAgICBjb25zb2xlLmxvZygn4pyFIEZGbXBlZyBtYXZqdWQnKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUubG9nKCfinYwgRkZtcGVnIHRvcGlsbWFkaSwgdmlkZW8ga29tcHJlc3NpeWEgb1xcJ2NoaXJpbGFkaScpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbi8vIFZpZGVvIGZheWxuaSBzaXFpc2hcclxuYXN5bmMgZnVuY3Rpb24gY29tcHJlc3NWaWRlbyhpbnB1dFBhdGgsIG91dHB1dFBhdGgsIG1pbWVUeXBlKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCfwn46sIFZpZGVvIGtvbXByZXNzaXlhIGJvc2hsYW5tb3FkYS4uLicpO1xyXG4gICAgY29uc29sZS5sb2coJ/Cfk6UgSW5wdXQ6JywgaW5wdXRQYXRoKTtcclxuICAgIGNvbnNvbGUubG9nKCfwn5OkIE91dHB1dDonLCBvdXRwdXRQYXRoKTtcclxuXHJcbiAgICBjb25zdCBmZm1wZWdDb21tYW5kID0gW1xyXG4gICAgICAnZmZtcGVnJyxcclxuICAgICAgJy1pJywgYFwiJHtpbnB1dFBhdGh9XCJgLFxyXG4gICAgICAnLWM6dicsIFZJREVPX0NPTVBSRVNTSU9OX1NFVFRJTkdTLmNvZGVjLFxyXG4gICAgICAnLWM6YScsIFZJREVPX0NPTVBSRVNTSU9OX1NFVFRJTkdTLmF1ZGlvQ29kZWMsXHJcbiAgICAgICctYjp2JywgVklERU9fQ09NUFJFU1NJT05fU0VUVElOR1MudmlkZW9CaXRyYXRlLFxyXG4gICAgICAnLWI6YScsIFZJREVPX0NPTVBSRVNTSU9OX1NFVFRJTkdTLmF1ZGlvQml0cmF0ZSxcclxuICAgICAgJy1yJywgVklERU9fQ09NUFJFU1NJT05fU0VUVElOR1MuZnBzLFxyXG4gICAgICAnLWNyZicsIFZJREVPX0NPTVBSRVNTSU9OX1NFVFRJTkdTLmNyZixcclxuICAgICAgJy1wcmVzZXQnLCBWSURFT19DT01QUkVTU0lPTl9TRVRUSU5HUy5wcmVzZXQsXHJcbiAgICAgICctdmYnLCBgc2NhbGU9JHtWSURFT19DT01QUkVTU0lPTl9TRVRUSU5HUy5yZXNvbHV0aW9ufTpmb3JjZV9vcmlnaW5hbF9hc3BlY3RfcmF0aW89ZGVjcmVhc2UscGFkPSR7VklERU9fQ09NUFJFU1NJT05fU0VUVElOR1MucmVzb2x1dGlvbn06KG93LWl3KS8yOihvaC1paCkvMmAsXHJcbiAgICAgICctbW92ZmxhZ3MnLCAnK2Zhc3RzdGFydCcsXHJcbiAgICAgICcteScsXHJcbiAgICAgIGBcIiR7b3V0cHV0UGF0aH1cImBcclxuICAgIF0uam9pbignICcpO1xyXG5cclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHsgc3Rkb3V0LCBzdGRlcnIgfSA9IGF3YWl0IGV4ZWNBc3luYyhmZm1wZWdDb21tYW5kLCB7XHJcbiAgICAgIHRpbWVvdXQ6IDMwMDAwMCxcclxuICAgICAgbWF4QnVmZmVyOiAxMDI0ICogMTAyNCAqIDEwXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIGNvbnN0IGR1cmF0aW9uID0gKChlbmRUaW1lIC0gc3RhcnRUaW1lKSAvIDEwMDApLnRvRml4ZWQoMik7XHJcblxyXG4gICAgaWYgKGV4aXN0c1N5bmMob3V0cHV0UGF0aCkpIHtcclxuICAgICAgY29uc3Qgb3JpZ2luYWxTdGF0cyA9IGF3YWl0IGZzLnN0YXQoaW5wdXRQYXRoKTtcclxuICAgICAgY29uc3QgY29tcHJlc3NlZFN0YXRzID0gYXdhaXQgZnMuc3RhdChvdXRwdXRQYXRoKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IG9yaWdpbmFsU2l6ZSA9IG9yaWdpbmFsU3RhdHMuc2l6ZTtcclxuICAgICAgY29uc3QgY29tcHJlc3NlZFNpemUgPSBjb21wcmVzc2VkU3RhdHMuc2l6ZTtcclxuICAgICAgY29uc3QgY29tcHJlc3Npb25SYXRpbyA9ICgob3JpZ2luYWxTaXplIC0gY29tcHJlc3NlZFNpemUpIC8gb3JpZ2luYWxTaXplICogMTAwKS50b0ZpeGVkKDIpO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coJ+KchSBWaWRlbyBrb21wcmVzc2l5YSB0dWdhZGknKTtcclxuICAgICAgY29uc29sZS5sb2coYPCfk4ogQXNsIGhham06ICR7KG9yaWdpbmFsU2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpfU1CYCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OKIFlhbmdpIGhham06ICR7KGNvbXByZXNzZWRTaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMil9TUJgKTtcclxuICAgICAgY29uc29sZS5sb2coYPCfk4ogVGVqYXNoOiAke2NvbXByZXNzaW9uUmF0aW99JWApO1xyXG4gICAgICBjb25zb2xlLmxvZyhg4o+x77iPIFZhcXQ6ICR7ZHVyYXRpb259c2ApO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIG9yaWdpbmFsU2l6ZSxcclxuICAgICAgICBjb21wcmVzc2VkU2l6ZSxcclxuICAgICAgICBjb21wcmVzc2lvblJhdGlvOiBwYXJzZUZsb2F0KGNvbXByZXNzaW9uUmF0aW8pLFxyXG4gICAgICAgIGR1cmF0aW9uOiBwYXJzZUZsb2F0KGR1cmF0aW9uKVxyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdLb21wcmVzc2l5YSBuYXRpamFzaWRhIGZheWwgeWFyYXRpbG1hZGknKTtcclxuICAgIH1cclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBWaWRlbyBrb21wcmVzc2l5YSB4YXRvc2k6JywgZXJyb3IubWVzc2FnZSk7XHJcbiAgICBcclxuICAgIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCd0aW1lb3V0JykgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnZmZtcGVnJykpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBLb21wcmVzc2l5YSBtdXZhZmZhcWl5YXRzaXosIGFzbCBmYXlsIGlzaGxhdGlsYWRpJyk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgdXNlT3JpZ2luYWw6IHRydWVcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBWaWRlbyBmYXlsIGVrYW5saWdpbmkgYW5pcWxhc2hcclxuZnVuY3Rpb24gaXNWaWRlb0ZpbGUobWltZVR5cGUsIGZpbGVuYW1lKSB7XHJcbiAgaWYgKG1pbWVUeXBlICYmIFZJREVPX0ZPUk1BVFMuaW5jbHVkZXMobWltZVR5cGUudG9Mb3dlckNhc2UoKSkpIHtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuICBcclxuICBjb25zdCB2aWRlb0V4dGVuc2lvbnMgPSBbJy5tcDQnLCAnLmF2aScsICcubW92JywgJy53bXYnLCAnLmZsdicsICcud2VibScsICcubWt2JywgJy4zZ3AnLCAnLm00diddO1xyXG4gIGNvbnN0IGV4dGVuc2lvbiA9IHBhdGguZXh0bmFtZShmaWxlbmFtZSkudG9Mb3dlckNhc2UoKTtcclxuICByZXR1cm4gdmlkZW9FeHRlbnNpb25zLmluY2x1ZGVzKGV4dGVuc2lvbik7XHJcbn1cclxuXHJcbi8vIEZheWwgbm9taW5pIHRvemFsYXNoXHJcbmZ1bmN0aW9uIHNhbml0aXplRmlsZW5hbWUoZmlsZW5hbWUpIHtcclxuICByZXR1cm4gZmlsZW5hbWVcclxuICAgIC5yZXBsYWNlKC9bXmEtekEtWjAtOVxcLV9cXC5dL2csICdfJylcclxuICAgIC5yZXBsYWNlKC9fezIsfS9nLCAnXycpXHJcbiAgICAudG9Mb3dlckNhc2UoKTtcclxufVxyXG5cclxuLy8gRmF5bG5pIENhdGJveC5tb2UgZ2EgeXVrbGFzaFxyXG5hc3luYyBmdW5jdGlvbiB1cGxvYWRGaWxlVG9DYXRib3goZmlsZVBhdGgsIGZpbGVOYW1lLCBtaW1lVHlwZSkge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIWV4aXN0c1N5bmMoZmlsZVBhdGgpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmF5bCB0b3BpbG1hZGk6ICR7ZmlsZVBhdGh9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ/Cfk6QgVXBsb2FkaW5nIHRvIENhdGJveDonLCBmaWxlTmFtZSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGZpbGVCdWZmZXIgPSBhd2FpdCBmcy5yZWFkRmlsZShmaWxlUGF0aCk7XHJcbiAgICBjb25zdCBmaWxlU2l6ZU1CID0gKGZpbGVCdWZmZXIubGVuZ3RoIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMik7XHJcbiAgICBjb25zb2xlLmxvZygn8J+TgSBGaWxlIHNpemU6JywgZmlsZVNpemVNQiwgJ01CJyk7XHJcblxyXG4gICAgLy8gS2F0dGEgZmF5bGxhciB1Y2h1biB3YXJuaW5nIChDYXRib3ggbWF4IDIwME1CLCBhbW1vIHVzZXIgMUdCIHNvJ3JhZ2FuLCBsZWtpbiBjaGVrbGFzaCBrb2RkYSBxbyd5aWxhZGkpXHJcbiAgICBpZiAoZmlsZUJ1ZmZlci5sZW5ndGggPiAyMDAgKiAxMDI0ICogMTAyNCkgeyAvLyAyMDBNQiBDYXRib3ggbGltaXRcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYXlsIGhham1pIENhdGJveC5tb2UgdWNodW4ganVkYSBrYXR0YSAobWF4IDIwME1CKScpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTtcclxuICAgIGZvcm0uYXBwZW5kKCdyZXF0eXBlJywgJ2ZpbGV1cGxvYWQnKTtcclxuICAgIGZvcm0uYXBwZW5kKCd1c2VyaGFzaCcsIENBVEJPWF9VU0VSX0hBU0gpO1xyXG4gICAgZm9ybS5hcHBlbmQoJ2ZpbGVUb1VwbG9hZCcsIGZpbGVCdWZmZXIsIHtcclxuICAgICAgZmlsZW5hbWU6IGZpbGVOYW1lLFxyXG4gICAgICBjb250ZW50VHlwZTogbWltZVR5cGUgfHwgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSdcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCfwn5SXIFVwbG9hZGluZyB0byBDYXRib3ggQVBJLi4uJyk7XHJcbiAgICBjb25zdCB1cGxvYWRTdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdChDQVRCT1hfQVBJX1VSTCwgZm9ybSwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgLi4uZm9ybS5nZXRIZWFkZXJzKClcclxuICAgICAgfSxcclxuICAgICAgdGltZW91dDogMzAwMDAwIC8vIDUgbWludXRcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHVwbG9hZER1cmF0aW9uID0gKChEYXRlLm5vdygpIC0gdXBsb2FkU3RhcnRUaW1lKSAvIDEwMDApLnRvRml4ZWQoMik7XHJcblxyXG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwIHx8ICFyZXNwb25zZS5kYXRhLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJykpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVcGxvYWQgbXV2YWZmYXFpeWF0c2l6OiAke3Jlc3BvbnNlLmRhdGF9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHVibGljVXJsID0gcmVzcG9uc2UuZGF0YS50cmltKCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ+KchSBVcGxvYWQgc3VjY2Vzc2Z1bDonLCBwdWJsaWNVcmwpO1xyXG4gICAgY29uc29sZS5sb2coJ+KPse+4jyBVcGxvYWQgdGltZTonLCB1cGxvYWREdXJhdGlvbiwgJ3NlY29uZHMnKTtcclxuICAgIGNvbnNvbGUubG9nKCfwn5OKIFVwbG9hZCBzcGVlZDonLCAoKGZpbGVCdWZmZXIubGVuZ3RoIC8gMTAyNCAvIDEwMjQpIC8gdXBsb2FkRHVyYXRpb24pLnRvRml4ZWQoMiksICdNQi9zJyk7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGZpbGVOYW1lOiBmaWxlTmFtZSxcclxuICAgICAgcHVibGljVXJsOiBwdWJsaWNVcmxcclxuICAgIH07XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgVXBsb2FkIGVycm9yOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgaWYgKGVycm9yLnJlc3BvbnNlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1VwbG9hZCByZXNwb25zZSBzdGF0dXM6JywgZXJyb3IucmVzcG9uc2Uuc3RhdHVzKTtcclxuICAgICAgY29uc29sZS5lcnJvcignVXBsb2FkIHJlc3BvbnNlIGRhdGE6JywgZXJyb3IucmVzcG9uc2UuZGF0YSk7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFVwbG9hZCB4YXRvc2k6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIFZhcXRpbmNoYWxpayBmYXlsbmkgbydjaGlyaXNoXHJcbmFzeW5jIGZ1bmN0aW9uIGNsZWFudXBUZW1wRmlsZShmaWxlUGF0aCkge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcclxuICAgICAgYXdhaXQgZnMudW5saW5rKGZpbGVQYXRoKTtcclxuICAgICAgY29uc29sZS5sb2coJ/Cfl5HvuI8gVGVtcCBmaWxlIGRlbGV0ZWQ6JywgZmlsZVBhdGgpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLndhcm4oJ+KaoO+4jyBUZW1wIGZpbGUgZGVsZXRpb24gd2FybmluZzonLCBlcnJvci5tZXNzYWdlKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgYXBpOiB7XHJcbiAgICBib2R5UGFyc2VyOiBmYWxzZSxcclxuICAgIHJlc3BvbnNlTGltaXQ6IGZhbHNlLFxyXG4gIH0sXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgXHJcbiAgICAgIGVycm9yOiBcIkZhcWF0IFBPU1Qgc28ncm92bGFyaSBxYWJ1bCBxaWxpbmFkaVwiLFxyXG4gICAgICBtZXRob2Q6IHJlcS5tZXRob2QgXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNvbnNvbGUubG9nKCfwn5qAIFN0YXJ0aW5nIHVwbG9hZCBwcm9jZXNzLi4uJyk7XHJcbiAgY29uc29sZS5sb2coJ/CfjJAgUmVxdWVzdCBoZWFkZXJzOicsIHtcclxuICAgICdjb250ZW50LXR5cGUnOiByZXEuaGVhZGVyc1snY29udGVudC10eXBlJ10sXHJcbiAgICAnY29udGVudC1sZW5ndGgnOiByZXEuaGVhZGVyc1snY29udGVudC1sZW5ndGgnXSxcclxuICAgICd1c2VyLWFnZW50JzogcmVxLmhlYWRlcnNbJ3VzZXItYWdlbnQnXVxyXG4gIH0pO1xyXG5cclxuICAvLyBGRm1wZWcgbWF2anVkbGlnaW5pIHRla3NoaXJpc2hcclxuICBjb25zdCBpc0ZGbXBlZ0F2YWlsYWJsZSA9IGF3YWl0IGNoZWNrRkZtcGVnQXZhaWxhYmlsaXR5KCk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyBWYXF0aW5jaGFsaWsgcGFwa2Egc296bGFzaFxyXG4gICAgbGV0IHRlbXBEaXI7XHJcbiAgICB0cnkge1xyXG4gICAgICB0ZW1wRGlyID0gb3MudG1wZGlyKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OBIFVzaW5nIHRlbXAgZGlyZWN0b3J5OicsIHRlbXBEaXIpO1xyXG4gICAgICBcclxuICAgICAgaWYgKCFleGlzdHNTeW5jKHRlbXBEaXIpKSB7XHJcbiAgICAgICAgYXdhaXQgZnMubWtkaXIodGVtcERpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk4EgQ3JlYXRlZCB0ZW1wIGRpcmVjdG9yeTonLCB0ZW1wRGlyKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAodGVtcEVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBUZW1wIGRpcmVjdG9yeSBlcnJvcjonLCB0ZW1wRXJyb3IubWVzc2FnZSk7XHJcbiAgICAgIHRlbXBEaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3RlbXAnKTtcclxuICAgICAgaWYgKCFleGlzdHNTeW5jKHRlbXBEaXIpKSB7XHJcbiAgICAgICAgYXdhaXQgZnMubWtkaXIodGVtcERpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk4EgQ3JlYXRlZCBmYWxsYmFjayB0ZW1wIGRpcmVjdG9yeTonLCB0ZW1wRGlyKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBGb3JtaWRhYmxlIHNvemxhbWFsYXJpIC0gbWF4IDFHQiBwZXIgZmlsZVxyXG4gICAgY29uc3QgZm9ybSA9IGZvcm1pZGFibGUoe1xyXG4gICAgICBtdWx0aXBsZXM6IHRydWUsXHJcbiAgICAgIHVwbG9hZERpcjogdGVtcERpcixcclxuICAgICAga2VlcEV4dGVuc2lvbnM6IHRydWUsXHJcbiAgICAgIGFsbG93RW1wdHlGaWxlczogZmFsc2UsXHJcbiAgICAgIG1pbkZpbGVTaXplOiAxLFxyXG4gICAgICBtYXhGaWxlU2l6ZTogMTAyNCAqIDEwMjQgKiAxMDI0LCAvLyAxR0JcclxuICAgICAgbWF4RmlsZXM6IEluZmluaXR5LCAgICBcclxuICAgICAgbWF4VG90YWxGaWxlU2l6ZTogSW5maW5pdHksXHJcbiAgICAgIG1heEZpZWxkc1NpemU6IEluZmluaXR5LFxyXG4gICAgICBjcmVhdGVEaXJzRnJvbVVwbG9hZHM6IHRydWUsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygn8J+TiyBQYXJzaW5nIGZvcm0gZGF0YS4uLicpO1xyXG4gICAgXHJcbiAgICBjb25zdCB7IGZpZWxkcywgZmlsZXMgfSA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgZm9ybS5wYXJzZShyZXEsIChlcnIsIGZpZWxkcywgZmlsZXMpID0+IHtcclxuICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRm9ybSBwYXJzaW5nIGVycm9yOicsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoYEZvcm0gcGFyc2luZyB4YXRvc2k6ICR7ZXJyLm1lc3NhZ2V9YCkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIEZvcm0gcGFyc2VkIHN1Y2Nlc3NmdWxseScpO1xyXG4gICAgICAgICAgcmVzb2x2ZSh7IGZpZWxkcywgZmlsZXMgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCfwn5OBIEZpbGVzIHJlY2VpdmVkOicsIE9iamVjdC5rZXlzKGZpbGVzKSk7XHJcbiAgICBjb25zb2xlLmxvZygn8J+TnSBGaWVsZHMgcmVjZWl2ZWQ6JywgT2JqZWN0LmtleXMoZmllbGRzKSk7XHJcblxyXG4gICAgaWYgKCFmaWxlcy5maWxlKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxyXG4gICAgICAgIGVycm9yOiAnSGVjaCBxYW5kYXkgZmF5bCB5dWtsYW5tYWRpJyxcclxuICAgICAgICByZWNlaXZlZDogT2JqZWN0LmtleXMoZmlsZXMpXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHVwbG9hZGVkRmlsZXMgPSBBcnJheS5pc0FycmF5KGZpbGVzLmZpbGUpID8gZmlsZXMuZmlsZSA6IFtmaWxlcy5maWxlXTtcclxuICAgIGNvbnN0IHRvdGFsU2l6ZSA9IHVwbG9hZGVkRmlsZXMucmVkdWNlKChzdW0sIGZpbGUpID0+IHN1bSArIChmaWxlLnNpemUgfHwgMCksIDApO1xyXG5cclxuICAgIGNvbnN0IHR5cGUgPSBBcnJheS5pc0FycmF5KGZpZWxkcy50eXBlKSA/IGZpZWxkcy50eXBlWzBdIDogKGZpZWxkcy50eXBlIHx8ICdwb3N0Jyk7XHJcbiAgICBjb25zdCB1c2VybmFtZSA9IEFycmF5LmlzQXJyYXkoZmllbGRzLnVzZXJuYW1lKSA/IGZpZWxkcy51c2VybmFtZVswXSA6IGZpZWxkcy51c2VybmFtZTtcclxuICAgIGNvbnN0IHBvc3RJbmRleCA9IEFycmF5LmlzQXJyYXkoZmllbGRzLnBvc3RJbmRleCkgPyBmaWVsZHMucG9zdEluZGV4WzBdIDogZmllbGRzLnBvc3RJbmRleDtcclxuXHJcbiAgICBpZiAoIXVzZXJuYW1lKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxyXG4gICAgICAgIGVycm9yOiAnVXNlcm5hbWUgbWFqYnVyaXknLFxyXG4gICAgICAgIGZpZWxkczogT2JqZWN0LmtleXMoZmllbGRzKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZyhg8J+TiiBVcGxvYWQgc2Vzc2lvbjogdHlwZT0ke3R5cGV9LCB1c2VybmFtZT0ke3VzZXJuYW1lfSwgZmlsZXM9JHt1cGxvYWRlZEZpbGVzLmxlbmd0aH1gKTtcclxuICAgIGNvbnNvbGUubG9nKGDwn5OKIFRvdGFsIHNpemU6ICR7KHRvdGFsU2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpfSBNQmApO1xyXG4gICAgY29uc29sZS5sb2coYPCfjqwgVmlkZW8gY29tcHJlc3Npb246ICR7aXNGRm1wZWdBdmFpbGFibGUgPyAnRU5BQkxFRCcgOiAnRElTQUJMRUQnfWApO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcclxuICAgIGNvbnN0IGVycm9ycyA9IFtdO1xyXG5cclxuICAgIC8vIEhhciBiaXIgZmF5bG5pIHl1a2xhc2hcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBsb2FkZWRGaWxlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBmaWxlID0gdXBsb2FkZWRGaWxlc1tpXTtcclxuICAgICAgbGV0IHRlbXBGaWxlUGF0aCA9IG51bGw7XHJcbiAgICAgIGxldCBjb21wcmVzc2VkRmlsZVBhdGggPSBudWxsO1xyXG4gICAgICBcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBvcmlnaW5hbE5hbWUgPSBmaWxlLm9yaWdpbmFsRmlsZW5hbWUgfHwgYGZpbGVfJHtpICsgMX1gO1xyXG4gICAgICAgIGNvbnN0IG1pbWVUeXBlID0gZmlsZS5taW1ldHlwZSB8fCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJztcclxuICAgICAgICBjb25zdCBmaWxlU2l6ZSA9IGZpbGUuc2l6ZSB8fCAwO1xyXG4gICAgICAgIHRlbXBGaWxlUGF0aCA9IGZpbGUuZmlsZXBhdGg7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5OkIFByb2Nlc3NpbmcgJHtpICsgMX0vJHt1cGxvYWRlZEZpbGVzLmxlbmd0aH06ICR7b3JpZ2luYWxOYW1lfWApO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5OKIFNpemU6ICR7KGZpbGVTaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMil9TUIsIFR5cGU6ICR7bWltZVR5cGV9YCk7XHJcblxyXG4gICAgICAgIGlmIChmaWxlU2l6ZSA9PT0gMCkge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCb1xcJ3NoIGZheWwnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghZXhpc3RzU3luYyh0ZW1wRmlsZVBhdGgpKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygn4o+zIEZpbGUgbm90IGZvdW5kLCB3YWl0aW5nIDEgc2Vjb25kLi4uJyk7XHJcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoIWV4aXN0c1N5bmModGVtcEZpbGVQYXRoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFZhcXRpbmNoYWxpayBmYXlsIHRvcGlsbWFkaTogJHt0ZW1wRmlsZVBhdGh9YCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBmaWxlU3RhdHMgPSBhd2FpdCBmcy5zdGF0KHRlbXBGaWxlUGF0aCk7XHJcbiAgICAgICAgY29uc3QgYWN0dWFsRmlsZVNpemUgPSBmaWxlU3RhdHMuc2l6ZTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZyhg8J+TiiBGaWxlIHN0YXRzOiByZXBvcnRlZD0ke2ZpbGVTaXplfSwgYWN0dWFsPSR7YWN0dWFsRmlsZVNpemV9YCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGFjdHVhbEZpbGVTaXplID09PSAwKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JvXFwnc2ggZmF5bCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVmlkZW8ga29tcHJlc3NpeWFcclxuICAgICAgICBsZXQgZmluYWxGaWxlUGF0aCA9IHRlbXBGaWxlUGF0aDtcclxuICAgICAgICBsZXQgZmluYWxGaWxlU2l6ZSA9IGFjdHVhbEZpbGVTaXplO1xyXG4gICAgICAgIGxldCBjb21wcmVzc2lvbkluZm8gPSBudWxsO1xyXG5cclxuICAgICAgICBpZiAoaXNGRm1wZWdBdmFpbGFibGUgJiYgaXNWaWRlb0ZpbGUobWltZVR5cGUsIG9yaWdpbmFsTmFtZSkpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn46sIFZpZGVvIGZheWwgYW5pcWxhbmRpLCBrb21wcmVzc2l5YSBib3NobGFubW9xZGEuLi4nKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgY29uc3QgY29tcHJlc3NlZE5hbWUgPSBgY29tcHJlc3NlZF8ke0RhdGUubm93KCl9XyR7cGF0aC5iYXNlbmFtZSh0ZW1wRmlsZVBhdGgsIHBhdGguZXh0bmFtZSh0ZW1wRmlsZVBhdGgpKX0ubXA0YDtcclxuICAgICAgICAgIGNvbXByZXNzZWRGaWxlUGF0aCA9IHBhdGguam9pbih0ZW1wRGlyLCBjb21wcmVzc2VkTmFtZSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbXByZXNzaW9uSW5mbyA9IGF3YWl0IGNvbXByZXNzVmlkZW8odGVtcEZpbGVQYXRoLCBjb21wcmVzc2VkRmlsZVBhdGgsIG1pbWVUeXBlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChjb21wcmVzc2lvbkluZm8uc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgIGZpbmFsRmlsZVBhdGggPSBjb21wcmVzc2VkRmlsZVBhdGg7XHJcbiAgICAgICAgICAgICAgZmluYWxGaWxlU2l6ZSA9IGNvbXByZXNzaW9uSW5mby5jb21wcmVzc2VkU2l6ZTtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFZpZGVvIGtvbXByZXNzaXlhIG11dmFmZmFxaXlhdGxpOiAke2NvbXByZXNzaW9uSW5mby5jb21wcmVzc2lvblJhdGlvfSUgdGVqYXNoYCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29tcHJlc3Npb25JbmZvLnVzZU9yaWdpbmFsKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBLb21wcmVzc2l5YSBpc2hsYW1hZGksIGFzbCBmYXlsIGlzaGxhdGlsYWRpJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gY2F0Y2ggKGNvbXByZXNzaW9uRXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFZpZGVvIGtvbXByZXNzaXlhIHhhdG9zaTonLCBjb21wcmVzc2lvbkVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygn4pqg77iPIEFzbCBmYXlsIGlzaGxhdGlsYWRpJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBGYXlsIG5vbWluaSB5YXJhdGlzaFxyXG4gICAgICAgIGNvbnN0IHNhZmVPcmlnaW5hbE5hbWUgPSBzYW5pdGl6ZUZpbGVuYW1lKG9yaWdpbmFsTmFtZSk7XHJcbiAgICAgICAgY29uc3QgZmlsZUV4dGVuc2lvbiA9IGNvbXByZXNzaW9uSW5mbz8uc3VjY2VzcyA/ICcubXA0JyA6IHBhdGguZXh0bmFtZShzYWZlT3JpZ2luYWxOYW1lKSB8fCAnJztcclxuICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIGNvbnN0IHJhbmRvbUlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDgpO1xyXG5cclxuICAgICAgICBsZXQgZmlsZU5hbWU7XHJcbiAgICAgICAgaWYgKHR5cGUgPT09ICdwcm9maWxlJykge1xyXG4gICAgICAgICAgZmlsZU5hbWUgPSBgcHJvZmlsZXMvJHt1c2VybmFtZX1fJHt0aW1lc3RhbXB9XyR7cmFuZG9tSWR9JHtmaWxlRXh0ZW5zaW9ufWA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNvbnN0IHBvc3RTdWZmaXggPSBwb3N0SW5kZXggPyBgX3Bvc3Qke3Bvc3RJbmRleH1gIDogJyc7XHJcbiAgICAgICAgICBjb25zdCBmaWxlU3VmZml4ID0gdXBsb2FkZWRGaWxlcy5sZW5ndGggPiAxID8gYF8ke2kgKyAxfWAgOiAnJztcclxuICAgICAgICAgIGZpbGVOYW1lID0gYHBvc3RzLyR7dXNlcm5hbWV9JHtwb3N0U3VmZml4fSR7ZmlsZVN1ZmZpeH1fJHt0aW1lc3RhbXB9XyR7cmFuZG9tSWR9JHtmaWxlRXh0ZW5zaW9ufWA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhg8J+OryBEZXN0aW5hdGlvbjogJHtmaWxlTmFtZX1gKTtcclxuXHJcbiAgICAgICAgLy8gRmF5bG5pIHl1a2xhc2hcclxuICAgICAgICBjb25zdCB1cGxvYWRSZXN1bHQgPSBhd2FpdCB1cGxvYWRGaWxlVG9DYXRib3goZmluYWxGaWxlUGF0aCwgZmlsZU5hbWUsIGNvbXByZXNzaW9uSW5mbz8uc3VjY2VzcyA/ICd2aWRlby9tcDQnIDogbWltZVR5cGUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVtdW1peSBVUkxcclxuICAgICAgICBjb25zdCBwdWJsaWNVcmwgPSB1cGxvYWRSZXN1bHQucHVibGljVXJsO1xyXG5cclxuICAgICAgICByZXN1bHRzLnB1c2goe1xyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgIHVybDogcHVibGljVXJsLFxyXG4gICAgICAgICAgZmlsZW5hbWU6IHVwbG9hZFJlc3VsdC5maWxlTmFtZSxcclxuICAgICAgICAgIG9yaWdpbmFsTmFtZTogb3JpZ2luYWxOYW1lLFxyXG4gICAgICAgICAgZmlsZVNpemU6IGZpbmFsRmlsZVNpemUsXHJcbiAgICAgICAgICBvcmlnaW5hbEZpbGVTaXplOiBhY3R1YWxGaWxlU2l6ZSxcclxuICAgICAgICAgIG1pbWVUeXBlOiBjb21wcmVzc2lvbkluZm8/LnN1Y2Nlc3MgPyAndmlkZW8vbXA0JyA6IG1pbWVUeXBlLFxyXG4gICAgICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgICAgIGZpbGVJbmRleDogaSArIDEsXHJcbiAgICAgICAgICB0b3RhbEZpbGVzOiB1cGxvYWRlZEZpbGVzLmxlbmd0aCxcclxuICAgICAgICAgIGNvbXByZXNzZWQ6IGNvbXByZXNzaW9uSW5mbz8uc3VjY2VzcyB8fCBmYWxzZSxcclxuICAgICAgICAgIGNvbXByZXNzaW9uUmF0aW86IGNvbXByZXNzaW9uSW5mbz8uY29tcHJlc3Npb25SYXRpbyB8fCBudWxsLFxyXG4gICAgICAgICAgY29tcHJlc3Npb25EdXJhdGlvbjogY29tcHJlc3Npb25JbmZvPy5kdXJhdGlvbiB8fCBudWxsLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFN1Y2Nlc3MgJHtpICsgMX0vJHt1cGxvYWRlZEZpbGVzLmxlbmd0aH06ICR7b3JpZ2luYWxOYW1lfWApO1xyXG5cclxuICAgICAgfSBjYXRjaCAoZmlsZUVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihg4p2MIEZpbGUgZXJyb3IgJHtpICsgMX0vJHt1cGxvYWRlZEZpbGVzLmxlbmd0aH06YCwgZmlsZUVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgIGVycm9ycy5wdXNoKHsgXHJcbiAgICAgICAgICBmaWxlbmFtZTogZmlsZS5vcmlnaW5hbEZpbGVuYW1lIHx8IGBmaWxlXyR7aSArIDF9YCwgXHJcbiAgICAgICAgICBlcnJvcjogZmlsZUVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgICBmaWxlSW5kZXg6IGkgKyAxIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgIC8vIFZhcXRpbmNoYWxpayBmYXlsbGFybmkgbydjaGlyaXNoXHJcbiAgICAgICAgaWYgKHRlbXBGaWxlUGF0aCkge1xyXG4gICAgICAgICAgYXdhaXQgY2xlYW51cFRlbXBGaWxlKHRlbXBGaWxlUGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb21wcmVzc2VkRmlsZVBhdGggJiYgY29tcHJlc3NlZEZpbGVQYXRoICE9PSB0ZW1wRmlsZVBhdGgpIHtcclxuICAgICAgICAgIGF3YWl0IGNsZWFudXBUZW1wRmlsZShjb21wcmVzc2VkRmlsZVBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIE5hdGlqYVxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSB7XHJcbiAgICAgIHN1Y2Nlc3M6IGVycm9ycy5sZW5ndGggPT09IDAsXHJcbiAgICAgIHVwbG9hZGVkOiByZXN1bHRzLFxyXG4gICAgICBlcnJvcnM6IGVycm9ycyxcclxuICAgICAgc3VtbWFyeToge1xyXG4gICAgICAgIHRvdGFsRmlsZXM6IHVwbG9hZGVkRmlsZXMubGVuZ3RoLFxyXG4gICAgICAgIHN1Y2Nlc3NmdWw6IHJlc3VsdHMubGVuZ3RoLFxyXG4gICAgICAgIGZhaWxlZDogZXJyb3JzLmxlbmd0aCxcclxuICAgICAgICB0b3RhbFNpemU6IHRvdGFsU2l6ZSA8IDEwMjQgKiAxMDI0IFxyXG4gICAgICAgICAgPyBgJHsodG90YWxTaXplIC8gMTAyNCkudG9GaXhlZCgyKX1LQmBcclxuICAgICAgICAgIDogYCR7KHRvdGFsU2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpfU1CYCxcclxuICAgICAgICB2aWRlb3NDb21wcmVzc2VkOiByZXN1bHRzLmZpbHRlcihyID0+IHIuY29tcHJlc3NlZCkubGVuZ3RoLFxyXG4gICAgICAgIGZmbXBlZ0F2YWlsYWJsZTogaXNGRm1wZWdBdmFpbGFibGUsXHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCfwn46JIFVwbG9hZCBjb21wbGV0ZTonLCByZXNwb25zZS5zdW1tYXJ5KTtcclxuXHJcbiAgICBjb25zdCBzdGF0dXNDb2RlID0gZXJyb3JzLmxlbmd0aCA9PT0gMCA/IDIwMCA6IChyZXN1bHRzLmxlbmd0aCA+IDAgPyAyMDcgOiA0MDApO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoc3RhdHVzQ29kZSkuanNvbihyZXNwb25zZSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgR2xvYmFsIGVycm9yOicsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgY29uc29sZS5lcnJvcignU3RhY2s6JywgZXJyb3Iuc3RhY2spO1xyXG4gICAgXHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcclxuICAgICAgZXJyb3I6ICdTZXJ2ZXIgeGF0b2xpZ2knLCBcclxuICAgICAgZGV0YWlsczogZXJyb3IubWVzc2FnZSxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGVudl9jaGVjazoge1xyXG4gICAgICAgIGhhc1VzZXJIYXNoOiAhIUNBVEJPWF9VU0VSX0hBU0gsXHJcbiAgICAgICAgbm9kZUVudjogcHJvY2Vzcy5lbnYuTk9ERV9FTlZcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImZvcm1pZGFibGUiLCJmcyIsImV4aXN0c1N5bmMiLCJwYXRoIiwib3MiLCJleGVjIiwicHJvbWlzaWZ5IiwiYXhpb3MiLCJGb3JtRGF0YSIsImV4ZWNBc3luYyIsIlNVUEFCQVNFX1VSTCIsIlNVUEFCQVNFX0FOT05fS0VZIiwiQ0FUQk9YX1VTRVJfSEFTSCIsIkNBVEJPWF9BUElfVVJMIiwiVklERU9fRk9STUFUUyIsIlZJREVPX0NPTVBSRVNTSU9OX1NFVFRJTkdTIiwicmVzb2x1dGlvbiIsInZpZGVvQml0cmF0ZSIsImF1ZGlvQml0cmF0ZSIsImZwcyIsImNvZGVjIiwiYXVkaW9Db2RlYyIsInByZXNldCIsImNyZiIsImNoZWNrRkZtcGVnQXZhaWxhYmlsaXR5Iiwic3Rkb3V0IiwiaW5jbHVkZXMiLCJjb25zb2xlIiwibG9nIiwiZXJyb3IiLCJjb21wcmVzc1ZpZGVvIiwiaW5wdXRQYXRoIiwib3V0cHV0UGF0aCIsIm1pbWVUeXBlIiwiZmZtcGVnQ29tbWFuZCIsImpvaW4iLCJzdGFydFRpbWUiLCJEYXRlIiwibm93Iiwic3RkZXJyIiwidGltZW91dCIsIm1heEJ1ZmZlciIsImVuZFRpbWUiLCJkdXJhdGlvbiIsInRvRml4ZWQiLCJvcmlnaW5hbFN0YXRzIiwic3RhdCIsImNvbXByZXNzZWRTdGF0cyIsIm9yaWdpbmFsU2l6ZSIsInNpemUiLCJjb21wcmVzc2VkU2l6ZSIsImNvbXByZXNzaW9uUmF0aW8iLCJzdWNjZXNzIiwicGFyc2VGbG9hdCIsIkVycm9yIiwibWVzc2FnZSIsInVzZU9yaWdpbmFsIiwiaXNWaWRlb0ZpbGUiLCJmaWxlbmFtZSIsInRvTG93ZXJDYXNlIiwidmlkZW9FeHRlbnNpb25zIiwiZXh0ZW5zaW9uIiwiZXh0bmFtZSIsInNhbml0aXplRmlsZW5hbWUiLCJyZXBsYWNlIiwidXBsb2FkRmlsZVRvQ2F0Ym94IiwiZmlsZVBhdGgiLCJmaWxlTmFtZSIsImZpbGVCdWZmZXIiLCJyZWFkRmlsZSIsImZpbGVTaXplTUIiLCJsZW5ndGgiLCJmb3JtIiwiYXBwZW5kIiwiY29udGVudFR5cGUiLCJ1cGxvYWRTdGFydFRpbWUiLCJyZXNwb25zZSIsInBvc3QiLCJoZWFkZXJzIiwiZ2V0SGVhZGVycyIsInVwbG9hZER1cmF0aW9uIiwic3RhdHVzIiwiZGF0YSIsInN0YXJ0c1dpdGgiLCJwdWJsaWNVcmwiLCJ0cmltIiwiY2xlYW51cFRlbXBGaWxlIiwidW5saW5rIiwid2FybiIsImNvbmZpZyIsImFwaSIsImJvZHlQYXJzZXIiLCJyZXNwb25zZUxpbWl0IiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsImpzb24iLCJpc0ZGbXBlZ0F2YWlsYWJsZSIsInRlbXBEaXIiLCJ0bXBkaXIiLCJta2RpciIsInJlY3Vyc2l2ZSIsInRlbXBFcnJvciIsInByb2Nlc3MiLCJjd2QiLCJtdWx0aXBsZXMiLCJ1cGxvYWREaXIiLCJrZWVwRXh0ZW5zaW9ucyIsImFsbG93RW1wdHlGaWxlcyIsIm1pbkZpbGVTaXplIiwibWF4RmlsZVNpemUiLCJtYXhGaWxlcyIsIkluZmluaXR5IiwibWF4VG90YWxGaWxlU2l6ZSIsIm1heEZpZWxkc1NpemUiLCJjcmVhdGVEaXJzRnJvbVVwbG9hZHMiLCJmaWVsZHMiLCJmaWxlcyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicGFyc2UiLCJlcnIiLCJPYmplY3QiLCJrZXlzIiwiZmlsZSIsInJlY2VpdmVkIiwidXBsb2FkZWRGaWxlcyIsIkFycmF5IiwiaXNBcnJheSIsInRvdGFsU2l6ZSIsInJlZHVjZSIsInN1bSIsInR5cGUiLCJ1c2VybmFtZSIsInBvc3RJbmRleCIsInJlc3VsdHMiLCJlcnJvcnMiLCJpIiwidGVtcEZpbGVQYXRoIiwiY29tcHJlc3NlZEZpbGVQYXRoIiwib3JpZ2luYWxOYW1lIiwib3JpZ2luYWxGaWxlbmFtZSIsIm1pbWV0eXBlIiwiZmlsZVNpemUiLCJmaWxlcGF0aCIsInNldFRpbWVvdXQiLCJmaWxlU3RhdHMiLCJhY3R1YWxGaWxlU2l6ZSIsImZpbmFsRmlsZVBhdGgiLCJmaW5hbEZpbGVTaXplIiwiY29tcHJlc3Npb25JbmZvIiwiY29tcHJlc3NlZE5hbWUiLCJiYXNlbmFtZSIsImNvbXByZXNzaW9uRXJyb3IiLCJzYWZlT3JpZ2luYWxOYW1lIiwiZmlsZUV4dGVuc2lvbiIsInRpbWVzdGFtcCIsInJhbmRvbUlkIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyaW5nIiwicG9zdFN1ZmZpeCIsImZpbGVTdWZmaXgiLCJ1cGxvYWRSZXN1bHQiLCJwdXNoIiwidXJsIiwib3JpZ2luYWxGaWxlU2l6ZSIsImZpbGVJbmRleCIsInRvdGFsRmlsZXMiLCJjb21wcmVzc2VkIiwiY29tcHJlc3Npb25EdXJhdGlvbiIsImZpbGVFcnJvciIsInVwbG9hZGVkIiwic3VtbWFyeSIsInN1Y2Nlc3NmdWwiLCJmYWlsZWQiLCJ2aWRlb3NDb21wcmVzc2VkIiwiZmlsdGVyIiwiciIsImZmbXBlZ0F2YWlsYWJsZSIsInN0YXR1c0NvZGUiLCJzdGFjayIsImRldGFpbHMiLCJ0b0lTT1N0cmluZyIsImVudl9jaGVjayIsImhhc1VzZXJIYXNoIiwibm9kZUVudiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/upload.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupload.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();